{"version":3,"sources":["../src/clientAction.es6"],"names":[],"mappings":";;;;;;AAAA,AAAC,CAAA,YAAY;AACZ,aAAY,CAAC;;AAEb,KAAI,CAAC,GAAG,OAAO,CAAC,YAAY,CAAC,CAAC;AAC9B,KAAI,KAAK,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC;AAC/B,KAAI,WAAW,GAAG,OAAO,CAAC,SAAS,CAAC,CAAC;;KAE/B,YAAY;AACL,WADP,YAAY,GACF;yBADV,YAAY;;AAEhB,OAAI,CAAC,YAAY,GAAG,EAAE,CAAC;;AAEvB,OAAI,CAAC,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,YAAwB;QAAd,OAAO,gCAAG,EAAE;;AACrD,WAAO,OAAO,CAAC,IAAI,CAAC,SAAS,IAAI,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;IAClF,EAAE,sBAAsB,CAAC,CAAC;;AAE3B,OAAI,CAAC,YAAY,CAAC,KAAK,CAAC,MAAM,EAAE,YAAwB;QAAd,OAAO,gCAAG,EAAE;;AACrD,WAAO,OAAO,CAAC,IAAI,CAAC,SAAS,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;IACjD,EAAE,sBAAsB,CAAC,CAAC;;AAE3B,OAAI,CAAC,YAAY,CAAC,KAAK,CAAC,KAAK,EAAE,YAAwB;QAAd,OAAO,gCAAG,EAAE;;AACpD,WAAO,IAAI,CAAC;IACZ,CAAC,CAAC;GACH;;eAfI,YAAY;;UAiBL,sBAAC,IAAI,EAAE,SAAS,EAAgB;QAAd,OAAO,gCAAG,EAAE;;AACzC,QAAI,CAAC,IAAI,EAAE,OAAO,KAAK,CAAC;AACxB,QAAI,CAAC,SAAS,EAAE,OAAO,KAAK,CAAC;AAC7B,QAAI,EAAE,SAAS,YAAY,QAAQ,CAAA,AAAC,EAAE,OAAO,KAAK,CAAC;AACnD,QAAI,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,EAAE,OAAO,KAAK,CAAC;;AAE1C,QAAI,CAAC,YAAY,CAAC,IAAI,CAAC,GAAG;AACzB,OAAE,EAAE,SAAS;AACb,YAAO,EAAE,OAAO;KAChB,CAAC;;AAEF,WAAO,IAAI,CAAC;IACZ;;;UAEc,yBAAC,IAAI,EAAE;AACrB,WAAO,OAAO,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC,CAAC;IACtC;;;UAEQ,kBAAC,IAAI,EAAgB;;;QAAd,OAAO,gCAAG,EAAE;;AAC3B,QAAI,MAAM,GAAG,KAAK;QAAE,KAAK,CAAC;;AAE1B,WAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM,EAAK;AACvC,SAAI,MAAM,GAAG,KAAK;SAAE,OAAO,GAAG,cAAc,CAAC;;AAE7C,SAAI,MAAK,YAAY,CAAC,IAAI,CAAC,IAAI,MAAK,YAAY,CAAC,IAAI,CAAC,CAAC,EAAE,YAAY,QAAQ,EAAE;AAC9E,YAAM,GAAG,MAAK,YAAY,CAAC,IAAI,CAAC,CAAC,EAAE,CAAC,OAAO,CAAC,CAAC;AAC7C,aAAO,GAAG,MAAK,YAAY,CAAC,IAAI,CAAC,CAAC,OAAO,CAAC;MAC1C;;AAED,YAAO,MAAM,GAAG,OAAO,CAAC,OAAO,CAAC,GAAG,MAAM,CAAC,IAAI,WAAW,CAAC,OAAO,CAAC,CAAC,CAAC;KACpE,CAAC,CAAC;IACH;;;SAhDI,YAAY;;;AAmDlB,OAAM,CAAC,OAAO,GAAG,YAAY,CAAC;CAC9B,CAAA,EAAE,CAAE","file":"src/clientAction.es6","sourcesContent":["(function () {\n\t\"use strict\";\n\n\tvar _ = require('underscore');\n\tvar FLAGS = require('./flags');\n\tvar ClientError = require('./error');\n\n\tclass ClientAction {\n\t\tconstructor () {\n\t\t\tthis.__validators = {};\n\n\t\t\tthis.addValidator(FLAGS.AUTHOR, function (options = {}) {\n\t\t\t\treturn options.chat.creatorId && options.chat.creatorId.equals(options.performer);\n\t\t\t}, 'Performer not author');\n\n\t\t\tthis.addValidator(FLAGS.MEMBER, function (options = {}) {\n\t\t\t\treturn options.chat.hasMember(options.performer);\n\t\t\t}, 'Performer not member');\n\n\t\t\tthis.addValidator(FLAGS.OTHER, function (options = {}) {\n\t\t\t\treturn true;\n\t\t\t});\n\t\t}\n\n\t\taddValidator(flag, validator, message = '') {\n\t\t\tif (!flag) return false;\n\t\t\tif (!validator) return false;\n\t\t\tif (!(validator instanceof Function)) return false;\n\t\t\tif (this.__validators[flag]) return false;\n\n\t\t\tthis.__validators[flag] = {\n\t\t\t\tcb: validator,\n\t\t\t\tmessage: message\n\t\t\t};\n\n\t\t\treturn true;\n\t\t}\n\n\t\tremoveValidator(flag) {\n\t\t\treturn delete this.__validators[flag];\n\t\t}\n\n\t\tvalidate (flag, options = {}) {\n\t\t\tvar result = false, error;\n\n\t\t\treturn new Promise((resolve, reject) => {\n\t\t\t\tvar result = false, message = 'Unknown flag';\n\n\t\t\t\tif (this.__validators[flag] && this.__validators[flag].cb instanceof Function) {\n\t\t\t\t\tresult = this.__validators[flag].cb(options);\n\t\t\t\t\tmessage = this.__validators[flag].message;\n\t\t\t\t}\n\n\t\t\t\treturn result ? resolve(options) : reject(new ClientError(message));\n\t\t\t});\n\t\t}\n\t}\n\n\tmodule.exports = ClientAction;\n}());"]}